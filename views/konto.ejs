<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Konto</title>
  <link rel="stylesheet" href="/styles/konto.css">
  <link rel="stylesheet" href="/styles/index.css">
</head>
<body>

  <% include partials/menyPanel %>

  <main class="main-content">
  <h1>Min konto</h1>
  <p>Her kan du se din konto</p>
  <div id="konto">konto</div>
  <div id="Eiendeler">Eiendeler</div>
  <a href="/"><button class="home-button">Home</button></a>
  </main>

<script>
  const brukernavn = localStorage.getItem('brukernavn');

  if (!brukernavn) {
    alert('Du må være logget inn for å se konto.');
    window.location.href = '/login';
  }

  fetch('/konto', {
    headers: {
      'brukernavn': brukernavn
    }
  })
    .then(res => {
      console.log('Lokal lagret brukernavn:', brukernavn);
      if (!res.ok) {
        throw new Error('Ikke logget inn');
      }
      return res.json();
    })
    .then(data => {
      console.log('Eiendeler:', data.items);
      // Vis data i UI
      const kontoContainer = document.getElementById('konto');
      if (data.items && data.items.length > 0) {
        data.items.forEach(item => {
          const itemElement = document.createElement('p');
          itemElement.textContent = `Eiendel: ${item.name}, Verdi: ${item.value}`;
          kontoContainer.appendChild(itemElement);
        });
      } else {
        kontoContainer.textContent = 'Ingen eiendeler funnet.';
      }
    })
    .catch(error => {
      alert(error.message);
      window.location.href = '/login';
    });
</script>
</body>
</html>